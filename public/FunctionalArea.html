<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Master Panel</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script> -->
<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>


<link rel="stylesheet" type="text/css" href="CssPage1.css">
    <script type="module" src="Script3/FunctionalAreaScript.js"></script>
    <script type = "text/javascript" src="jQuery.js"></script>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round|Open+Sans">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">  
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />





<link href=
"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css"
         rel="stylesheet">
         <!-- <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css"> -->

<!-- <script src="https://cdn.datatables.net/1.12.1/css/dataTables.bootstrap5.min.css"></script> -->
<!-- <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js"></script>
<script src="src/fancyTable.js"></script>

<script type="text/javascript" src="/public/pagesort.js"></script>


<link href="https://unpkg.com/bootstrap-table@1.21.0/dist/bootstrap-table.min.css" rel="stylesheet">
<script src="https://unpkg.com/bootstrap-table@1.21.0/dist/bootstrap-table.min.js"></script>
<script src="https://cdn.jsdelivr.net/n pm/jquery.fancytable/dist/fancyTable.min.js"></script> 
<script src="src/fancyTable.js"></script>

  </head>
  <body style="color: white !important;">
    <!-- code for the master page -->
    <div id="wrapper" class="toggled">
      <div id="sidebar-wrapper">
        <div class="logo">
          <img src="logoimage.png" class="logoimg" alt="">
        </div>
          <ul class="sidebar-nav">
             <li>
                <button style="text-align: left; background-color:transparent;border: none; color: white;" onclick="location.href = 'Certification.html'" id="defaultOpen">Certification</button>
              </li>
              <li>
                <button style="text-align: left; background-color:transparent;border: none; margin-top: 20px; color: white;"  onclick="location.href = 'JobTypes.html'" id="defaultOpen">JobTypes</button>
              </li>
              <li>
                <button style="text-align: left; background-color:transparent;border: none;color: white;margin-top: 20px;" onclick="location.href = 'Qualification.html'" id="defaultOpen2">Qualification</button>
              </li>
              <li>
                <button style="text-align: left; background-color:transparent;border: none;color: white;margin-top: 20px;" onclick="location.href = 'Skills.html'" id="defaultOpen3">Skills</button>
              </li>
              <li>
                <button style="text-align: left; background-color:transparent;border: none;color: white;margin-top: 20px;" onclick="location.href = 'FunctionalArea.html'" id="defaultOpen4">Functional Area</button>
              </li>
              <li>
                <button style="text-align: left; background-color:transparent;border: none;color: white;margin-top: 20px;" onclick="location.href = 'Cities.html'" id="defaultOpen5">Cities</button>
              </li>
              <li>
                <button style="text-align: left; background-color:transparent;border: none;color: white;margin-top: 20px;" onclick="location.href = 'Specialization.html'" id="defaultOpen6">Specialization</button>
              </li>
              <li>
                <button class="dropbtn" style="text-align: left; background-color:transparent;border: none;color: white;margin-top: 20px;" onclick="location.href = 'BlogMaster.html'" id="defaultOpen7">Blog Master</button>
              </li>
              <li>
                <button style="text-align: left; background-color:transparent;border: none;color: white;margin-top: 20px;" onclick="location.href = 'PackageMaster.html'" id="defaultOpen8">Package Master</button>
              </li>
              <li>
                <button style="text-align: left; background-color:transparent;border: none;color: white;margin-top: 20px;" onclick="location.href = 'ChangePassword.html'" id="defaultOpen9">Change Password</button>
              </li>
              
          </ul>
      </div>

 
  <!-- functionalarea-->
  <div id="functionalarea" class="tabcontent">
    <a href="#menu-toggle4" style="background-color: #454d55;"  class="tgl-btn" id="menu-toggle4"><i style="color: white; border-top-left-radius:0px" class="fa fa-bars"></i></a>
    <button type="button" style="color: white;" class="btn add-btn" onclick="Logoutfunc()"><i class="fa fa-power-off"></i></button>
      
    <div id="page-content-wrapper">
        <div class="m-1">
          <button style="float: right;margin-top: 60px;color: white;" type="button" class="btn add-btn" onclick="openForm()"><i class="fa fa-plus"></i> Add New</button>
        </div>
        <h1 style="color: white;">Functional Area</h1>
      <table id="myTableFunc" class="table myTableFunc" style="column-width: 1px;">
      <thead>
        <tr style="color: white;">
          <th>Category</th>
          <!-- <th>CId</th> -->
          <th>SubCategory</th>
          <!-- <th>SId</th> -->
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="tbody4" style="color: white;">
      </tbody>
    </table>
    </div>
    <dialog id="favDialog" style="position:absolute; bottom: auto; width: fit-content; height: fit-content;">
      <form method="dialog">
        <div>
          <label>Enter FunctionalArea Category:</label>
          <input class="input-box-330" type="text" name="categoryName" id="categoryName" required>
        </div> 
        <div>
          <label>Enter FunctionalArea SubCategory:</label>
          <input class="input-box-330" type="text" name="subCategoryName" id="subCategoryName" required>
        </div> 
        <input type="hidden" id="id" name="id"> 
        <div style="align-items: right;">
          <button type="submit" id="subbut" class="sub-btn" onclick="myFunctionFunctAre()" >Submit</button>
          <input id="cancelButton" style="background-color: white; color:black; margin-left: 10px;" class="sub-btn" onClick="closeForm()" type="button" value="Cancel">
        </div>
      </form>    
      </dialog>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/jquery.fancytable/dist/fancyTable.min.js"></script> 
<script>
$( window ).on("load", function() {
    setTimeout(async function(){ 
  $(".myTableFunc").fancyTable({ 	
    globalSearch: true,
    sortable: true,
    pagination: true, 			
    perPage:5, 				
  });
}, 1000);
});

function openForm() {
  document.querySelector("#favDialog").showModal();
}

function closeForm() {
  document.querySelector("#favDialog").close();
  location.reload(true);
}

document.querySelector("#favDialog").addEventListener('cancel', function(e) {
	e.preventDefault();
});
</script>


  
  <script type="module">
  // import EditorJS from '@editorjs/editorjs';
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-analytics.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js";
    import { doc, deleteDoc,setDoc, getDoc, getDocs, collection, addDoc, query, orderBy, limit, updateDoc } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js";

    const firebaseConfig = {
  apiKey: "AIzaSyAADC0o-0zy-R8WWzSY4hq_ckhLzNv6CHM",
  authDomain: "hobyjoby-8b9ca.firebaseapp.com",
  projectId: "hobyjoby-8b9ca",
  storageBucket: "hobyjoby-8b9ca.appspot.com",
  messagingSenderId: "755782612092",
  appId: "1:755782612092:web:98ed2fb25735eb435985f9",
  measurementId: "G-L23JY97GH8"
};
    
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
      const db = getFirestore(app);

      

      var dateTime = new Date().toLocaleString().replace(',','');
 
 //FunctionalArea
 window.myFunctionFunctAre = async function() {

    var table = document.getElementById("myTableFunc");
    var categoryName = document.getElementById("categoryName").value;
    var subCategoryName = document.getElementById("subCategoryName").value;
    var dbID = document.getElementById("id").value;
    var a=table.rows.length;
    var b=table.rows.length;
    var ao;
    const snapshot =  await getDocs(collection(db, "JobConfig", "Master", "FunctionalArea"));
    if(!snapshot.empty)
    {
      const ids = snapshot.docs.map(doc => (!isNaN(parseInt((doc.id) ? doc.id : '0'))) ? parseInt((doc.id) ? doc.id : '0') : 0)
      const max = Math.max(...ids);
      ao = parseInt(max) + 1;
    }
    if(ao == null)
    {
      ao =1;
    }
    let text;
  
    if (categoryName == null || categoryName == "" || subCategoryName == null || subCategoryName == "") {
    text = "User cancelled the prompt.";
    } else {
      if(dbID == null || dbID == ""){
        await setDoc(doc(db, "JobConfig", "Master", "FunctionalArea",ao.toString()), {
                        CId: '1',
                        Category:categoryName.toString(),
                        SCId : ao.toString(),
                        SubCategory: subCategoryName.toString()
                    })
                    .then(()=> {  
                    setTimeout("location.reload(true);",120);
                    })     
                    .catch((error)=>{
                        console.log(error);
                    }); 
      }
      else{
        updateDoc(doc(db, "JobConfig", "Master", "FunctionalArea", dbID.toString()), {
                            CId: '1',
                            Category:categoryName.toString(),
                            SCId : dbID.toString(),
                            SubCategory: subCategoryName.toString()
                          })   
                          .then(()=> {  
                            setTimeout("location.reload(true);",120);
                          })     
                          .catch((error)=>{
                              console.log(error);
                          }); 
      }
    }
 }
  
 window.Logoutfunc = function(){
    if (confirm("Are you sure you want to log out?") == true) {
      window.location.replace("index.html");

    } else {
        window.location.reload();
    }
   
  }
                                                               
  </script>

  </body>
</html>
