<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Master Panel</title>

 <!-- styles-->
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
 <link rel="stylesheet" type="text/css" href="Style/style.css">
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
 <link href="https://unpkg.com/bootstrap-table@1.21.0/dist/bootstrap-table.min.css" rel="stylesheet">
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">



 <!--scripts>-->
 <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" referrerpolicy="no-referrer"></script>
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
 <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
 <script type="module" src="Script3/QualificationScript.js"></script>
 <script type="text/javascript" src="jQuery.js"></script>
 <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
 <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
 <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
 <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js"></script>
 <script src="src/fancyTable.js"></script>
 <script type="text/javascript" src="/public/pagesort.js"></script>
 <script src="https://unpkg.com/bootstrap-table@1.21.0/dist/bootstrap-table.min.js"></script>
 <script src="https://cdn.jsdelivr.net/n pm/jquery.fancytable/dist/fancyTable.min.js"></script>
 <script src="src/fancyTable.js"></script>

  </head>
  <body>
    <!-- code for the master page -->
    <div id="wrapper" class="toggled">
      <div id="sidebar-wrapper">
          <div class="logo">
              <img src="logoimage.png" class="logoimg" alt="">
          </div>

          <div class="vertical-menu">
              <a href="#home" >Dashboard</a>

              <div class="subnav-content">
                  <a href="Certification.html">Certification</a>
                  <a href="JobTypes.html">Job Types</a>
                  <a  href="Qualification.html">Qualification</a>
                  <a href="FunctionalArea.html">Functional Area</a>
                  <a href="Cities.html">Cities</a>
                  <a href="Skills.html">Skills</a>
                  <a href="Specialization.html">Specialization</a>
                  <a class="active" href="PackageMaster.html">PackageMaster</a>
                  <a href="CouponMaster.html">Coupon Master</a>
                  <a href="EmployerMaster.html">Employer Master</a>
                  <a href="CandidateMaster.html">Candidate Master</a>
                  <a href="SubscriptionMaster.html">Subscription Master</a>
                  <a href="ChangePassword.html">Change Password</a>
              </div>
              <div class="subnav-content">
                  <a href="#home">Reports</a>
              </div>
              <a href="#contact">Contact</a>
          </div>
          
      </div>
 
 
      <div id="blog" class="tabcontent">
        <a href="#menu-toggle6"  class="tgl-btn" id="menu-toggle6"><i style="color: white; border-top-left-radius:0px" class="fa fa-bars"></i></a>
        <button type="button" style="color: white;" class="btn add-btn" onclick="Logoutfunc()"><i class="fa fa-power-off"></i></button>
        
        <div id="page-content-wrapper">
        <!-- <div class="header"> -->
          <h1>Package Master</h1>
          <div class="row">
            <div class="col-md-12">
                <div style="margin-top:20px;">
                    <label>Enter Name:</label>
                    <input class="input-box-330" type="text" name="packageName" id="packageName" required>
                    <label style="margin-left:10px;">Enter Validity:</label>
                    <select name="validityType" id="validityType" onchange="yesnoCheck(this);" style="width:190px; height: 30px;" required>
                      <option value="0">Select from below:</option>
                      <option value="1" selected>Days</option>
                      <option value="2">Months</option>
                    </select>
                    <input style="margin-left:10px;"  class="input-box-330" type="number" name="packageValidity" id="packageValidity" value="Enter Value pleases" required>
                    <label style="margin-left:10px;">Enter Price:</label>
                    <input class="input-box-330" type="text" name="packagePrice" id="packagePrice" required>
                  </div> 
            </div>
          </div>
        <!-- </div> -->
        
        <div class="row">
          <div class="col-md-10">
            <div class="card p-0">
              <div class="card-title crd-t">
                <h4 style="font-size: 2rem;" class="p-2 px-3">Features:</h4>
              </div>
              <form method="post">
                <textarea class="ckeditor" id="editor" name="packageFeature" style="color: black;" rows="10" cols="80" ></textarea>
            </form> 
        </div>
          </div>
         
              <!-- <button class="dropbtn1" style="background-color:black;border: none;color: white;text-align:center;" onclick="openMaster(event, 'blogtable')">Blog List</button> -->
              <div class="Button" style="margin-top:20px;">
                <button type="submit" id="subbut" onclick="myFunction1()" class="sub-btn">Submit</button>
                <input id="cancelButton" style="background-color: white; color:black;" class="sub-btn" onClick="location.href = 'PackageMaster.html'" type="button" value="Cancel">
            </div>
          </div>
        
        </div>
        
      </div>
    
    </div>
    <script>
      function yesnoCheck(that) {
      if (that.value == 1 || that.value == 2) {
        $('#packageValidity').show();
      } else {
        $('#packageValidity').hide();
      }
  }
  $('#MasterOpen').on('click', function() {
  $("#MasterSubMenu").show();
});
$('#DashboardOpen').on('click', function() {
  $("#MasterSubMenu").hide();
});
$('#ReportsOpen').on('click', function() {
  $("#MasterSubMenu").hide();
});
      </script>
<script type="module">
    
    // import EditorJS from '@editorjs/editorjs';
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-analytics.js";
      import { getFirestore } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js";
      import { doc, deleteDoc,setDoc, getDoc, getDocs, collection, query, orderBy, limit , where, updateDoc} from "https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js";
  
      const firebaseConfig = {
    apiKey: "AIzaSyAADC0o-0zy-R8WWzSY4hq_ckhLzNv6CHM",
    authDomain: "hobyjoby-8b9ca.firebaseapp.com",
    projectId: "hobyjoby-8b9ca",
    storageBucket: "hobyjoby-8b9ca.appspot.com",
    messagingSenderId: "755782612092",
    appId: "1:755782612092:web:98ed2fb25735eb435985f9",
    measurementId: "G-L23JY97GH8"
  };
      
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore(app);
  
        var dateTime = new Date().toLocaleString().replace(',','');

        var queryString = window.location.search.substring(1);
        var varArray = queryString.split("="); //eg. index.html?msg=1
        var param = varArray[1];
  

        $( window ).on("load", async function() {
      
        // var q1 =  query(collection(db, "BlogMaster"),where("id", "==","fuggAHthAuIfsPmwmrAF"),limit(1));
        var querySnapshot = await getDoc(doc(db, "JobConfig", "Master", "PackageMaster",param));
        document.getElementById("packageName").value = querySnapshot.data().PackageName;
        document.getElementById("packageValidity").value = querySnapshot.data().validity;
        document.getElementById("packagePrice").value = querySnapshot.data().price;
        CKEDITOR.instances.editor.setData(querySnapshot.data().featurescolumns);
        //document.getElementById("textboc").value = title;
  
        });
        window.myFunction1 =  async function (){
  
            var packageName = document.getElementById("packageName").value;
            if(document.getElementById("validityType").value == 1){
              var packageValidity = document.getElementById("packageValidity").value;
            }
            else{
              var packageValidity = document.getElementById("packageValidity").value * 30;
            }
            var packagePrice = document.getElementById("packagePrice").value;
            var type =  CKEDITOR.instances.editor.getData();
            var content = removeTags(type);
            if (packageName == null || packageName == "" || content == null || content == "" || packageValidity == null || packageValidity == "" || packagePrice == null || packagePrice == "") {
                text = "Please provide all required data.";
            } else {
                updateDoc(doc(db, "JobConfig", "Master", "PackageMaster", param.toString()), {
                          PackageName: packageName.toString(),
                          featurescolumns:content.toString(),
                          price:packagePrice.toString(),
                          validity:packageValidity,
                          id : param.toString(),
                          UpdatedAt: dateTime.toString(),
                          UpdatedBy: "1"
                        })
                        .then(()=> {  
                            setTimeout("location.href = 'PackageMaster.html'",120);
                          })     
                          .catch((error)=>{
                              console.log(error);
                          }); 
            }
        }
    
    
        window.removeTags = function(str){
        if ((str===null) || (str===''))
            return false;
        else
            str = str.toString();
              
        // Regular expression to identify HTML tags in 
        // the input string. Replacing the identified 
        // HTML tag with a null string.
        return str.replace( /(<([^>]+)>)/ig, '');
    }
    
    
    window.Logoutfunc = function(){
    if (confirm("Are you sure you want to log out?") == true) {
      window.location.replace("index.html");

    } else {
        window.location.reload();
    }
   
  }
                                                                 
    </script>
  
    </body>
  </html>
  