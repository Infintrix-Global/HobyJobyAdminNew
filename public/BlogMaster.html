<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Master Panel</title>

  <!-- styles-->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="Style/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link href="https://unpkg.com/bootstrap-table@1.21.0/dist/bootstrap-table.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">



  <!--scripts>-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" referrerpolicy="no-referrer"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
  <script type="module" src="Script3/QualificationScript.js"></script>
  <script type="text/javascript" src="jQuery.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js"></script>
  <script src="src/fancyTable.js"></script>
  <script type="text/javascript" src="/public/pagesort.js"></script>
  <script src="https://unpkg.com/bootstrap-table@1.21.0/dist/bootstrap-table.min.js"></script>
  <script src="https://cdn.jsdelivr.net/n pm/jquery.fancytable/dist/fancyTable.min.js"></script>
  <script src="src/fancyTable.js"></script>

  </head>
  <body>
    <!-- code for the master page -->
    <div id="wrapper" class="toggled">
      <div id="sidebar-wrapper">
          <div class="logo">
              <img src="logoimage.png" class="logoimg" alt="">
          </div>

          <div class="vertical-menu">
              <a href="#home" >Dashboard</a>

              <div class="subnav-content">
                  <a href="Certification.html">Certification</a>
                  <a href="JobTypes.html">Job Types</a>
                  <a href="Qualification.html">Qualification</a>
                  <a href="FunctionalArea.html">Functional Area</a>
                  <a href="Cities.html">Cities</a>
                  <a  class="active" href="BlogMaster.html">Cities</a>
                  <a href="Specialization.html">Specialization</a>
                  <a href="PackageMaster.html">PackageMaster</a>
                  <a href="CouponMaster.html">Coupon Master</a>
                  <a href="EmployerMaster.html">Employer Master</a>
                  <a href="CandidateMaster.html">Candidate Master</a>
                  <a href="SubscriptionMaster.html">Subscription Master</a>
                  <a href="ChangePassword.html">Change Password</a>
              </div>
              <div class="subnav-content">
                  <a href="#home">Reports</a>
              </div>
              <a href="#contact">Contact</a>
          </div>
          
      </div>

 
 
      <div id="blog" class="tabcontent">
        <a href="#menu-toggle6" style="background-color: #454d55;"  class="tgl-btn" id="menu-toggle6"><i style="color: white; border-top-left-radius:0px" class="fa fa-bars"></i></a>
        <button type="button" style="color: white;" class="btn add-btn" onclick="Logoutfunc()"><i class="fa fa-power-off"></i></button>
        
        <div id="page-content-wrapper">
        <!-- <div class="header"> -->
          <h1>Blog Master</h1>
          <div class="row">
            <div class="col-md-8">
              <div class="bg-t">
                <h4 id="texthead" style="font-size: 2rem;" class="p-2 px-3"> Title </h4>
                <input type="text" contenteditable="true" id="textboc" class="mx-3 m-3">
              </div>
            </div>
    
            <div class="col-md-4">
              <button class="dropbtn1" style="font-size: 2rem;background-color:black;border: none;color: white;text-align:center;" onclick="location.href = 'BlogMasterList.html'">Blog List</button>
            </div>
          </div>
        <!-- </div> -->
        
        <div class="row">
          <div class="col-md-8">
            <div class="card p-0">
              <div class="card-title crd-t">
                <h4 style="font-size: 2rem;" class="p-2 px-3">Description</h4>
              </div>
              <form method="post">
                <textarea class="ckeditor" id="editor" name="content" style="color: black;" rows="10" cols="80" ></textarea>
            </form> 
        </div>
          </div>
          <div class="col-md-4">
            <div class="card height1 p-0">
                <table class="thisis border-0" >
                    <div class="card-title crd-t">
                      <h3 style="font-size: 2rem;" class="p-2 px-3">Companies  Name</h3>
                    </div>
                    <thead>
                        <tbody id="empname" style="border: none;"></tbody>
                    </thead>
                </table>
    
            </div>
            <div class="col-md-4">
              <!-- <button class="dropbtn1" style="background-color:black;border: none;color: white;text-align:center;" onclick="openMaster(event, 'blogtable')">Blog List</button> -->
            </div>
          </div>
        
        </div>
        
        
        <div class="footer">
            <div class="Button">
                <button type="submit" id="subbut" onclick="myFunction1()" class="sub-btn">Submit</button>
                <input id="cancelButton" style="background-color: white; color:black;" class="sub-btn" onClick="window.location.reload();" type="button" value="Cancel">
            </div>
        </div>
        
      </div>
    
    </div>

    <script src="https://cdn.jsdelivr.net/npm/jquery.fancytable/dist/fancyTable.min.js"></script> 
<script>
$( window ).on("load", function() {
    setTimeout(async function(){ 
  $(".blogtable").fancyTable({ 	
    globalSearch: true,
    sortable: true,
    pagination: true, 			
    perPage:5, 				
  });
}, 1000);
});
$('#MasterOpen').on('click', function() {
  $("#MasterSubMenu").show();
});
$('#DashboardOpen').on('click', function() {
  $("#MasterSubMenu").hide();
});
$('#ReportsOpen').on('click', function() {
  $("#MasterSubMenu").hide();
});
function ckChange(el) {
  var ckName = document.getElementsByName(el.name);
  for (var i = 0, c; c = ckName[i]; i++) {
   c.disabled = !(!el.checked || c === el);
  }
}

</script>


  
  <script type="module">
    
  // import EditorJS from '@editorjs/editorjs';
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-analytics.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js";
    import { doc, deleteDoc,setDoc, getDoc, getDocs, collection, query, orderBy, limit, addDoc } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js";

    const firebaseConfig = {
  apiKey: "AIzaSyAADC0o-0zy-R8WWzSY4hq_ckhLzNv6CHM",
  authDomain: "hobyjoby-8b9ca.firebaseapp.com",
  projectId: "hobyjoby-8b9ca",
  storageBucket: "hobyjoby-8b9ca.appspot.com",
  messagingSenderId: "755782612092",
  appId: "1:755782612092:web:98ed2fb25735eb435985f9",
  measurementId: "G-L23JY97GH8"
};
    
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
      const db = getFirestore(app);

      
  var dateTime = new Date().toLocaleString().replace(',','');

  var tbody= document.getElementById("empname");
  
  
      function AddItemToTable(cat,cby,uat, company){
  
        if(company.length > 0)
         {
          
          for(var i=0; i < company.length ; i ++)
          {

          let trow=document.createElement("tr");
          let td1=document.createElement("td");
          let td2 = document.createElement("td");

            td1.innerHTML= company[i].CompanyName;
          
         
          
          var x = document.createElement("INPUT");
          x.setAttribute("type", "checkbox");
          x.setAttribute("id", "city");
          x.setAttribute("name", "info");
          x.setAttribute("value", company[i].CompanyId);
          x.setAttribute("onClick","ckChange(this)")
          td2.appendChild(x);
  
          trow.appendChild(td1);
          trow.appendChild(td2);
          tbody.appendChild(trow);
            }
         }
      }
  
      window.myFunction1 =  async function (){


        var type =  CKEDITOR.instances.editor.getData();
        var content = removeTags(type);
       
        var ao;
        const snapshot =  await getDocs(collection(db, "BlogMaster"));
        if(!snapshot.empty)
        {
          const ids = snapshot.docs.map(doc => (!isNaN(parseInt((doc.id) ? doc.id : '0'))) ? parseInt((doc.id) ? doc.id : '0') : 0)
          const max = Math.max(...ids);
          ao = parseInt(max) + 1;
        }
        if(ao == null)
        {
          ao =1;
        }
        var head = document.getElementById("textboc").value;

                  var checkboxes = document.getElementById("city").value;
                  $(document).ready(function() {
                          var arr = [];
                          var checkboxs=document.getElementsByName("info");
                          var okay=false;
                          for(var i=0,l=checkboxs.length;i<l;i++)
                          {
                              if(checkboxs[i].checked)
                              {
                                  okay=true;
                                  break;
                              }
                          }

                          if(okay){
                              $.each($("input[name='info']:checked"), async function(){
                                  arr.push($(this).val());
                                  // alert($(this).val());
                                  var stringmas = String($(this).val());
                                  await setDoc(doc(db, "BlogMaster",ao.toString()), {
                                      CreatedAt: dateTime.toString(),
                                      CreatedBy:"1" ,
                                      Description: content.toString(),
                                      CompanyId: stringmas,
                                      Title: head.toString(),  
                                      UpdatedAt: dateTime.toString(),
                                      UpdatedBy: "1",
                                      id: ao.toString()
                                  })
                                  .then(()=> {  
                                    setTimeout("location.href = 'BlogMasterList.html'",120);
                                  })     
                                  .catch((error)=>{
                                      console.log(error);
                                  }); 
          
                              });
                           }
                          else{
                            alert("Please Select At least One Employer");
                          }
                  });
      }
  
  
      window.removeTags = function(str){
      if ((str===null) || (str===''))
          return false;
      else
          str = str.toString();
            
      // Regular expression to identify HTML tags in 
      // the input string. Replacing the identified 
      // HTML tag with a null string.
      return str.replace( /(<([^>]+)>)/ig, '');
  }
  
      function AddAllItemsToTable(certification){
          tbody.innerHTML="";
  
          certification.forEach(element => {
          AddItemToTable(element.FirstName,element.LastName,element.UserID,element.Company);    
          });
  
      }
  var cert=[];
  var querySnapshot = await getDocs(collection(db, "EmployerMaster"));
  querySnapshot.forEach((doc) => {
      cert.push(doc.data());
    AddAllItemsToTable(cert);
  
  });
  
  window.Logoutfunc = function(){
    if (confirm("Are you sure you want to log out?") == true) {
      window.location.replace("index.html");

    } else {
        window.location.reload();
    }
   
  }
                                                               
  </script>

  </body>
</html>
